<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ movie.Title }} - Reviews</title>
    <style>
        body { font-family: Arial, sans-serif; background: #111; color: #fff; padding: 20px; margin: 0; }
        .container { max-width: 900px; margin: auto; background: #1a1a1a; padding: 20px; border-radius: 8px; }
        h1, h2 { color: #f39c12; }
        a { color: #f39c12; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .back-link { display: inline-block; margin-bottom: 20px; }

        /* Movie Details */
        .movie-details { display: flex; gap: 20px; margin-bottom: 30px; }
        .movie-details img { width: 200px; height: auto; border-radius: 8px; }
        .movie-info { flex-grow: 1; }
        .movie-info h1 { margin-top: 0; }
        .movie-info p { margin: 5px 0; color: #ccc; }
        .movie-info .plot { margin-top: 15px; line-height: 1.6; }

        /* Reviews Section */
        .reviews-section { margin-top: 30px; }
        .review { background: #222; padding: 15px; border-radius: 5px; margin-bottom: 15px; border-left: 3px solid #f39c12; }
        .review-author { font-weight: bold; color: #fff; }
        .review-meta { font-size: 0.9em; color: #888; margin-bottom: 10px; }
        .review-rating { color: #f39c12; }

        /* Review Form */
        .review-form { margin-top: 30px; }
        .review-form h2 { margin-bottom: 15px; }
        .review-form textarea { width: 100%; background: #333; color: #fff; border: 1px solid #444; border-radius: 5px; padding: 10px; min-height: 100px; box-sizing: border-box; }
        .review-form .rating-group { margin-bottom: 15px; }
        .review-form select { padding: 8px; border-radius: 5px; background: #333; color: #fff; border: 1px solid #444; }
        .review-form button { padding: 10px 15px; border: none; border-radius: 5px; background: #f39c12; color: #fff; cursor: pointer; font-size: 16px; }
        .review-form button:hover { background: #e67e22; }
    </style>
</head>
<body>
    <div class="container">
        <a href="{% url 'movies-list-html' %}" class="back-link">&larr; Back to Movie List</a>

        <!-- Movie Details -->
        <div class="movie-details">
            <img src="{{ movie.Poster }}" alt="{{ movie.Title }} Poster">
            <div class="movie-info">
                <h1>{{ movie.Title }}</h1>
                <p><strong>Year:</strong> {{ movie.Year }}</p>
                <p><strong>Rated:</strong> {{ movie.Rated }}</p>
                <p><strong>Released:</strong> {{ movie.Released }}</p>
                <p><strong>Director:</strong> {{ movie.Director }}</p>
                <p><strong>IMDb Rating:</strong> {{ movie.imdbRating }}</p>
                <p class="plot">{{ movie.Plot }}</p>
            </div>
        </div>

        <!-- Reviews Section -->
        <div class="reviews-section">
            <h2>Reviews</h2>
            {% for review in reviews %}
                <div class="review">
                    <p class="review-author">{{ review.user.username }}</p>
                    <p class="review-meta">
                        <span class="review-rating">Rating: {{ review.rating }}/10</span> - 
                        <span class="review-date">{{ review.created_at|date:"F j, Y" }}</span>
                    </p>
                    <p>{{ review.content }}</p>
                </div>
            {% empty %}
                <p>No reviews yet. Be the first to write one!</p>
            {% endfor %}
        </div>

        <!-- Review Form -->
        <div class="review-form">
            <h2>Write Your Review</h2>
            {% if user.is_authenticated %}
                <form method="post">
                    {% csrf_token %}
                    <div class="rating-group">
                        <label for="rating">Rating:</label>
                        <select name="rating" id="rating" required>
                            <option value="">--Select a rating--</option>
                            <option value="10">10 - Masterpiece</option>
                            <option value="9">9 - Excellent</option>
                            <option value="8">8 - Very Good</option>
                            <option value="7">7 - Good</option>
                            <option value="6">6 - Fine</option>
                            <option value="5">5 - Average</option>
                            <option value="4">4 - Bad</option>
                            <option value="3">3 - Very Bad</option>
                            <option value="2">2 - Horrible</option>
                            <option value="1">1 - Appalling</option>
                        </select>
                    </div>
                    <textarea name="content" placeholder="What did you think of the movie?" required></textarea>
                    <br><br>
                    <button type="submit">Submit Review</button>
                </form>
            {% else %}
                <p>You must be <a href="{% url 'login' %}">logged in</a> to write a review.</p>
            {% endif %}
        </div>

    </div>
</body>
</html>
